{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { StatusBar } from 'expo-status-bar';\nimport React, { useEffect, useState } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { fetch_rendered_data } from \"../DataServer\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar stopFetchMore = true;\n\nvar renderItem = function renderItem(_ref) {\n  var item = _ref.item;\n  return _jsxs(Text, {\n    style: {\n      textAlign: 'center',\n      fontWeight: 'bold',\n      fontSize: 20,\n      padding: 15,\n      borderBottomColor: 'red',\n      borderBottomWidth: 2\n    },\n    children: [item.ticker, \"  : \", item.name]\n  });\n};\n\nvar _ListFooterComponent = function ListFooterComponent() {\n  return _jsx(Text, {\n    style: {\n      fontSize: 16,\n      fontWeight: 'bold',\n      textAlign: 'center',\n      padding: 5\n    },\n    children: \"Loading...\"\n  });\n};\n\nvar ScrollLoad = function ScrollLoad() {\n  var quantity_rendered = 20;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      render_index = _useState4[0],\n      set_render_index = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loadingMore = _useState6[0],\n      setLoadingMore = _useState6[1];\n\n  var updateData = function updateData() {\n    var response;\n    return _regeneratorRuntime.async(function updateData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(fetch_rendered_data(quantity_rendered, render_index));\n\n          case 2:\n            response = _context.sent;\n            console.log(render_index);\n            if (response) setData(_toConsumableArray(response));else setData([\"error\", \"DataServer.js\", \"didnt return the promise\"]);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    set_render_index(render_index + quantity_rendered);\n    updateData();\n  }, []);\n\n  var handleOnEndReached = function handleOnEndReached() {\n    var response;\n    return _regeneratorRuntime.async(function handleOnEndReached$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            setLoadingMore(true);\n\n            if (stopFetchMore) {\n              _context2.next = 10;\n              break;\n            }\n\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(fetch_rendered_data(quantity_rendered, render_index));\n\n          case 4:\n            response = _context2.sent;\n\n            if (!(response === 'done')) {\n              _context2.next = 7;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", setLoadingMore(false));\n\n          case 7:\n            stopFetchMore = true;\n            set_render_index(render_index + quantity_rendered);\n            setData([].concat(_toConsumableArray(data), _toConsumableArray(response)));\n\n          case 10:\n            setLoadingMore(false);\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return _jsx(FlatList, {\n    data: data,\n    keyExtractor: function keyExtractor(item) {\n      return data.indexOf(item);\n    },\n    renderItem: renderItem,\n    onEndReached: handleOnEndReached,\n    onEndReachedThreshold: 0.05,\n    onScrollBeginDrag: function onScrollBeginDrag() {\n      stopFetchMore = false;\n    },\n    ListFooterComponent: function ListFooterComponent() {\n      return loadingMore && _jsx(_ListFooterComponent, {});\n    }\n  });\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n    margin: 50\n  }\n});\nexport default ScrollLoad;","map":{"version":3,"sources":["C:/Users/affan/Desktop/JavaScript/REACT/projects/ticVoter/components/ScrollLoad.js"],"names":["StatusBar","React","useEffect","useState","fetch_rendered_data","stopFetchMore","renderItem","item","textAlign","fontWeight","fontSize","padding","borderBottomColor","borderBottomWidth","ticker","name","ListFooterComponent","ScrollLoad","quantity_rendered","data","setData","render_index","set_render_index","loadingMore","setLoadingMore","updateData","response","console","log","handleOnEndReached","indexOf","styles","StyleSheet","create","container","flex","backgroundColor","alignItems","justifyContent","margin"],"mappings":"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","sourcesContent":["import { StatusBar } from 'expo-status-bar';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { FlatList, StyleSheet, Text, View } from 'react-native';\r\nimport { fetch_rendered_data } from '../DataServer';\r\n\r\n\r\n\r\n// check to halt load requests\r\nlet stopFetchMore = true;\r\n\r\n\r\n\r\n// DATA ARRAY ITEM VIEW\r\nconst renderItem = ({ item }) => {\r\n    // console.log(item)\r\n    return (\r\n        <Text\r\n            style={{\r\n                textAlign: 'center',\r\n                fontWeight: 'bold',\r\n                fontSize: 20,\r\n                padding: 15,\r\n                borderBottomColor: 'red',\r\n                borderBottomWidth: 2,\r\n            }}\r\n        >\r\n            {item.ticker }  : {item.name}\r\n        </Text>\r\n    );\r\n};\r\n// LOADING VIEW\r\nconst ListFooterComponent = () => (\r\n    <Text\r\n        style={{\r\n            fontSize: 16,\r\n            fontWeight: 'bold',\r\n            textAlign: 'center',\r\n            padding: 5,\r\n        }}\r\n    >\r\n        Loading...\r\n    </Text>\r\n);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// MAIN COMPONENT\r\nconst ScrollLoad = () => {\r\n\r\n\r\n    // states , fetch data and init variables\r\n    const quantity_rendered = 20;\r\n    const [data, setData] = useState([]);\r\n    const [render_index, set_render_index] = useState(0);\r\n    const [loadingMore, setLoadingMore] = useState(false);\r\n\r\n    const updateData = async () => {\r\n        \r\n        // gets data from server.js\r\n        const response = await fetch_rendered_data(quantity_rendered , render_index) \r\n        console.log(render_index)\r\n        // check if we got data from DataServer.js\r\n        if (response) setData([...response]);\r\n        else setData([\"error\", \"DataServer.js\", \"didnt return the promise\"])\r\n    };\r\n\r\n    // on page render\r\n    useEffect(() => {\r\n        set_render_index(render_index + quantity_rendered)\r\n        updateData()\r\n    }, []);\r\n\r\n\r\n\r\n    // load more unless server resolves done\r\n    const handleOnEndReached = async () => {\r\n        setLoadingMore(true);\r\n        if (!stopFetchMore) {\r\n            const response = await fetch_rendered_data(quantity_rendered , render_index);\r\n            if (response === 'done') return setLoadingMore(false);\r\n            stopFetchMore = true;\r\n            set_render_index(render_index + quantity_rendered)\r\n            setData([...data, ...response]);\r\n        }\r\n        setLoadingMore(false);\r\n    };\r\n\r\n\r\n\r\n    return (\r\n        <FlatList\r\n            data={data}\r\n            keyExtractor={item => data.indexOf(item)}\r\n            renderItem={renderItem}\r\n            onEndReached={handleOnEndReached}\r\n            onEndReachedThreshold={0.05}\r\n            onScrollBeginDrag={() => {\r\n                stopFetchMore = false;\r\n            }}\r\n            ListFooterComponent={() => loadingMore && <ListFooterComponent />}\r\n        />\r\n    );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        backgroundColor: '#fff',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        margin: 50\r\n    },\r\n});\r\n\r\n\r\n\r\n\r\nexport default ScrollLoad"]},"metadata":{},"sourceType":"module"}