{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport { useNavigation } from '@react-navigation/core';\nimport { fetch_rendered_data } from \"../api_config/DataServer\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar quantity_rendered = require(\"../api_config/config.json\").qty_rendered;\n\nvar stopFetchMore = true;\n\nvar _ListFooterComponent = function ListFooterComponent() {\n  return _jsx(Text, {\n    style: {\n      fontSize: 16,\n      fontWeight: 'bold',\n      textAlign: 'center',\n      padding: 5\n    },\n    children: \"Loading...\"\n  });\n};\n\nvar ScrollLoad = function ScrollLoad() {\n  var navigation = useNavigation();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      render_index = _useState4[0],\n      set_render_index = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loadingMore = _useState6[0],\n      setLoadingMore = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      search = _useState8[0],\n      setSearch = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      all_stocks = _useState10[0],\n      setStocksData = _useState10[1];\n\n  var build_data = function build_data() {\n    fetch('http://localhost:8000/api/build_internal').then(function (response) {\n      return response.json();\n    }).then(function (json) {\n      return setStocksData(json);\n    }).catch(function (error) {\n      return console.error(error);\n    });\n  };\n\n  var user_varified = auth.currentUser.emailVerified;\n\n  var _useState11 = useState(''),\n      _useState12 = _slicedToArray(_useState11, 2),\n      display_date_ticker = _useState12[0],\n      setDisplay_data_ticker = _useState12[1];\n\n  var _useState13 = useState(''),\n      _useState14 = _slicedToArray(_useState13, 2),\n      display_date_voteCard = _useState14[0],\n      setDisplay_data_voteCard = _useState14[1];\n\n  var ticker_info = function ticker_info(ticker) {\n    fetch(CONFIG.base_url + \"/api/tickers/\" + ticker).then(function (response) {\n      return response.json();\n    }).then(function (json) {\n      return setDisplay_data_ticker(json);\n    }).catch(function (error) {\n      return console.error(error);\n    });\n  };\n\n  var voteCard_info = function voteCard_info(ticker) {\n    fetch(CONFIG.base_url + \"/api/votes/\" + ticker).then(function (response) {\n      return response.json();\n    }).then(function (json) {\n      return setDisplay_data_voteCard(json);\n    }).catch(function (error) {\n      return console.error(error);\n    });\n  };\n\n  var vote = function vote(ticker, opinion) {\n    var response, json;\n    return _regeneratorRuntime.async(function vote$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(fetch(CONFIG.base_url + \"/api/votes/\" + ticker + \"/\" + opinion, {\n              method: 'POST',\n              headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                user: auth.currentUser\n              })\n            }));\n\n          case 2:\n            response = _context.sent;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(response.json());\n\n          case 5:\n            json = _context.sent;\n            ticker_info(route.params.data.ticker);\n            voteCard_info(route.params.data.ticker);\n            return _context.abrupt(\"return\", json);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function _callee() {\n    return _regeneratorRuntime.async(function _callee$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            updateData();\n            build_data();\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }, []);\n\n  var renderItem = function renderItem(_ref) {\n    var item = _ref.item;\n    return _jsx(TouchableOpacity, {\n      onPress: function onPress() {\n        navigation.navigate(\"Vote\", {\n          data: item\n        });\n      },\n      style: styles.stock_button,\n      activeOpacity: 0.25,\n      children: _jsxs(Text, {\n        title: styles.stock_button_text,\n        children: [item.ticker, \"  : \", item.name]\n      })\n    });\n  };\n\n  var updateData = function updateData() {\n    var response;\n    return _regeneratorRuntime.async(function updateData$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            set_render_index(render_index + quantity_rendered);\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(fetch_rendered_data(quantity_rendered, render_index));\n\n          case 3:\n            response = _context3.sent;\n            if (response) setData(_toConsumableArray(response));else setData([\"error\", \"DataServer.js\", \"didnt return the promise\"]);\n\n          case 5:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleOnEndReached = function handleOnEndReached() {\n    var response;\n    return _regeneratorRuntime.async(function handleOnEndReached$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            setLoadingMore(true);\n\n            if (stopFetchMore) {\n              _context4.next = 10;\n              break;\n            }\n\n            _context4.next = 4;\n            return _regeneratorRuntime.awrap(fetch_rendered_data(quantity_rendered, render_index));\n\n          case 4:\n            response = _context4.sent;\n\n            if (!(response === 'done')) {\n              _context4.next = 7;\n              break;\n            }\n\n            return _context4.abrupt(\"return\", setLoadingMore(false));\n\n          case 7:\n            stopFetchMore = true;\n            setData([].concat(_toConsumableArray(data), _toConsumableArray(response)));\n            set_render_index(render_index + quantity_rendered);\n\n          case 10:\n            setLoadingMore(false);\n\n          case 11:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var searchFilterFunction = function searchFilterFunction(text) {\n    if (text) {\n      var newData = all_stocks.filter(function (item) {\n        var itemData = item.name.toUpperCase().includes(text.toUpperCase()) || item.ticker.toUpperCase().includes(text.toUpperCase()) ? item.ticker : '';\n        var textData = text.toUpperCase();\n        return itemData.indexOf(textData) > -1;\n      });\n      setData(newData);\n      setSearch(text);\n    } else {\n      setSearch(text);\n      set_render_index(0);\n      updateData();\n    }\n  };\n\n  return _jsxs(View, {\n    children: [_jsx(View, {\n      style: styles.search_bar_container,\n      children: _jsx(TextInput, {\n        style: styles.textInputStyle,\n        onChangeText: function onChangeText(text) {\n          return searchFilterFunction(text);\n        },\n        value: search,\n        underlineColorAndroid: \"transparent\",\n        placeholder: \"Search Here\"\n      })\n    }), _jsx(FlatList, {\n      data: data,\n      keyExtractor: function keyExtractor(item) {\n        return data.indexOf(item);\n      },\n      renderItem: renderItem,\n      onEndReached: handleOnEndReached,\n      onEndReachedThreshold: 0.01,\n      onScrollBeginDrag: function onScrollBeginDrag() {\n        stopFetchMore = false;\n      },\n      ListFooterComponent: function ListFooterComponent() {\n        return loadingMore && _jsx(_ListFooterComponent, {});\n      }\n    })]\n  });\n};\n\nvar styles = StyleSheet.create({\n  stock_button: {\n    textAlign: 'center',\n    fontWeight: 'bold',\n    fontSize: 20,\n    padding: 15,\n    borderBottomColor: '#009688',\n    borderBottomWidth: 2\n  },\n  stock_button_text: {\n    textAlign: 'center',\n    fontWeight: 'bold',\n    fontSize: 20,\n    padding: 15,\n    borderBottomColor: '#009688',\n    borderBottomWidth: 2\n  },\n  itemStyle: {\n    padding: 10\n  },\n  textInputStyle: {\n    height: 50,\n    width: \"100%\",\n    borderWidth: 1,\n    paddingLeft: 20,\n    margin: 50,\n    borderColor: '#009688',\n    backgroundColor: '#FFFFFF'\n  },\n  search_bar_container: {\n    backgroundColor: '#000000',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginTop: 25,\n    height: 55\n  }\n});\nexport default ScrollLoad;","map":{"version":3,"sources":["C:/Users/affan/Desktop/JavaScript/REACT/projects/ticVoter/components/ScrollLoad.js"],"names":["React","useEffect","useState","useNavigation","fetch_rendered_data","quantity_rendered","require","qty_rendered","stopFetchMore","ListFooterComponent","fontSize","fontWeight","textAlign","padding","ScrollLoad","navigation","data","setData","render_index","set_render_index","loadingMore","setLoadingMore","search","setSearch","all_stocks","setStocksData","build_data","fetch","then","response","json","catch","error","console","user_varified","auth","currentUser","emailVerified","display_date_ticker","setDisplay_data_ticker","display_date_voteCard","setDisplay_data_voteCard","ticker_info","ticker","CONFIG","base_url","voteCard_info","vote","opinion","method","headers","Accept","body","JSON","stringify","user","route","params","updateData","renderItem","item","navigate","styles","stock_button","stock_button_text","name","handleOnEndReached","searchFilterFunction","text","newData","filter","itemData","toUpperCase","includes","textData","indexOf","search_bar_container","textInputStyle","StyleSheet","create","borderBottomColor","borderBottomWidth","itemStyle","height","width","borderWidth","paddingLeft","margin","borderColor","backgroundColor","alignItems","justifyContent","marginTop"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { FlatList, StyleSheet, Text, View, TouchableOpacity, TextInput } from 'react-native';\r\nimport { useNavigation } from '@react-navigation/core';\r\n\r\n\r\n\r\nimport { fetch_rendered_data } from '../api_config/DataServer';\r\n\r\n// const CONFIG = require(\"../api_config/config.json\") \r\nconst quantity_rendered = require(\"../api_config/config.json\").qty_rendered\r\n\r\n\r\n// check to halt load requests\r\nlet stopFetchMore = true;\r\n\r\n\r\n\r\n// LOADING VIEW\r\nconst ListFooterComponent = () => (\r\n    <Text\r\n        style={{\r\n            fontSize: 16,\r\n            fontWeight: 'bold',\r\n            textAlign: 'center',\r\n            padding: 5,\r\n        }}\r\n    >\r\n        Loading...\r\n    </Text>\r\n);\r\n\r\n\r\n\r\n\r\n// MAIN COMPONENT\r\nconst ScrollLoad = () => {\r\n\r\n    // SCREEN STACK\r\n    const navigation = useNavigation()\r\n\r\n    // const quantity_rendered = CONFIG.qty_rendered;\r\n\r\n\r\n\r\n    \r\n    // STATES\r\n    const [data, setData] = useState([]);\r\n    const [render_index, set_render_index] = useState(0);\r\n    const [loadingMore, setLoadingMore] = useState(false);\r\n    const [search, setSearch] = useState('');\r\n    const [all_stocks, setStocksData] = useState([])\r\n    const build_data = () => {\r\n        fetch('http://localhost:8000/api/build_internal')\r\n            .then((response) => response.json())\r\n            .then((json) => setStocksData(json))\r\n            .catch((error) => console.error(error))\r\n    }\r\n\r\n\r\n    \r\n\r\n\r\n    const user_varified = auth.currentUser.emailVerified\r\n    // STATES\r\n    const [display_date_ticker, setDisplay_data_ticker] = useState('')\r\n    const [display_date_voteCard, setDisplay_data_voteCard] = useState('')\r\n    // DISPLAY_INFO FETCH DATA\r\n    const ticker_info =  (ticker) => {\r\n        fetch(`${CONFIG.base_url}/api/tickers/${ticker}`)\r\n            .then((response) => response.json())\r\n            .then((json) => setDisplay_data_ticker(json))\r\n            .catch((error) => console.error(error))\r\n    }\r\n    const voteCard_info =  (ticker) => {\r\n        fetch(`${CONFIG.base_url}/api/votes/${ticker}`)\r\n            .then((response) => response.json())\r\n            .then((json) => setDisplay_data_voteCard(json))\r\n            .catch((error) => console.error(error))\r\n    }\r\n    // POST VOTES\r\n    const vote = async (ticker, opinion) => {\r\n        let response = await fetch(`${CONFIG.base_url}/api/votes/${ticker}/${opinion}`, {\r\n            method: 'POST',\r\n            headers: { Accept: 'application/json', 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ user: auth.currentUser }),\r\n        });\r\n\r\n        let json = await response.json();\r\n        ticker_info(route.params.data.ticker)\r\n        voteCard_info(route.params.data.ticker)\r\n        return json;\r\n    }\r\n\r\n\r\n    \r\n\r\n\r\n\r\n\r\n    // HOOK : on page render\r\n    useEffect(async () => {\r\n        updateData()\r\n        build_data()\r\n    }, []);\r\n\r\n\r\n\r\n\r\n    // DATA ARRAY ITEM VIEW\r\n    const renderItem = ({ item }) => {\r\n        return (\r\n            <TouchableOpacity\r\n                onPress={() => {\r\n                    navigation.navigate(\"Vote\", { data: item })\r\n                }}\r\n                style={styles.stock_button}\r\n                activeOpacity={0.25}\r\n            >\r\n                <Text title={styles.stock_button_text} >\r\n                    {item.ticker}  : {item.name}\r\n                </Text>\r\n            </TouchableOpacity>\r\n        );\r\n    };\r\n\r\n\r\n    // UPDATE STATE OF DISPLAY DATA VIA SCROLL\r\n    const updateData = async () => {\r\n        set_render_index(render_index + quantity_rendered)\r\n        // gets data from server.js\r\n        const response = await fetch_rendered_data(quantity_rendered, render_index)\r\n        // check if we got data from DataServer.js\r\n        if (response) setData([...response]);\r\n        else setData([\"error\", \"DataServer.js\", \"didnt return the promise\"])\r\n    };\r\n\r\n\r\n\r\n    // load more unless server resolves done\r\n    const handleOnEndReached = async () => {\r\n        setLoadingMore(true);\r\n        if (!stopFetchMore) {\r\n            const response = await fetch_rendered_data(quantity_rendered, render_index); //fetch\r\n            if (response === 'done') return setLoadingMore(false);\r\n            stopFetchMore = true;\r\n            setData([...data, ...response]); // append to [state list]\r\n            set_render_index(render_index + quantity_rendered) // add 20 to last index\r\n        }\r\n        setLoadingMore(false);\r\n    };\r\n\r\n\r\n\r\n\r\n\r\n    // SEARCH BAR\r\n    const searchFilterFunction = (text) => {\r\n        // console.log(all_stocks)\r\n\r\n        // Check if searched text is not blank\r\n        if (text) {\r\n            const newData = all_stocks.filter(function (item) {\r\n                // console.log(item)\r\n\r\n                // Applying filter for the inserted text in search bar\r\n                const itemData =\r\n                    item.name.toUpperCase().includes(text.toUpperCase()) ||\r\n                        item.ticker.toUpperCase().includes(text.toUpperCase())\r\n                        ? item.ticker : ''\r\n                const textData = text.toUpperCase();\r\n                return itemData.indexOf(textData) > -1;\r\n            });\r\n            setData(newData);\r\n            setSearch(text);\r\n        } else {\r\n            // Inserted text is blank\r\n            setSearch(text);\r\n            set_render_index(0)\r\n            updateData()\r\n        }\r\n    };\r\n\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <View>\r\n\r\n\r\n\r\n            {/* SEARCH */}\r\n            <View style={styles.search_bar_container}>\r\n                <TextInput\r\n                    style={styles.textInputStyle}\r\n                    onChangeText={(text) => searchFilterFunction(text)}\r\n                    value={search}\r\n                    underlineColorAndroid=\"transparent\"\r\n                    placeholder=\"Search Here\"\r\n                />\r\n            </View>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n            {/* DISPLAY */}\r\n            <FlatList\r\n                data={data}\r\n                keyExtractor={item => data.indexOf(item)}\r\n                renderItem={renderItem}\r\n                onEndReached={handleOnEndReached}\r\n                onEndReachedThreshold={0.01}\r\n                onScrollBeginDrag={() => {\r\n                    stopFetchMore = false;\r\n                }}\r\n                ListFooterComponent={() => loadingMore && <ListFooterComponent />}\r\n            // onScroll={(event) => console.log(event)}\r\n            />\r\n\r\n\r\n\r\n\r\n        </View>\r\n\r\n    );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n\r\n    stock_button: {\r\n        textAlign: 'center',\r\n        fontWeight: 'bold',\r\n        fontSize: 20,\r\n        padding: 15,\r\n        borderBottomColor: '#009688',\r\n        borderBottomWidth: 2,\r\n    },\r\n    stock_button_text: {\r\n        textAlign: 'center',\r\n        fontWeight: 'bold',\r\n        fontSize: 20,\r\n        padding: 15,\r\n        borderBottomColor: '#009688',\r\n        borderBottomWidth: 2,\r\n    },\r\n\r\n    itemStyle: {\r\n        padding: 10,\r\n    },\r\n    textInputStyle: {\r\n        height: 50,\r\n        width: \"100%\",\r\n        borderWidth: 1,\r\n        paddingLeft: 20,\r\n        margin: 50,\r\n        borderColor: '#009688',\r\n        backgroundColor: '#FFFFFF',\r\n    },\r\n    search_bar_container: {\r\n        backgroundColor: '#000000',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        marginTop: 25,\r\n        height: 55,\r\n    },\r\n\r\n\r\n});\r\n\r\n\r\n\r\n\r\nexport default ScrollLoad"]},"metadata":{},"sourceType":"module"}